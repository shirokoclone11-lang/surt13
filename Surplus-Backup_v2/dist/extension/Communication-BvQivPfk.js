function e(e){if(!a)try{a=new BroadcastChannel(n),c="master"===e,a.onmessage=e=>{(e=>{if(e&&e.type&&!c&&"PING"===e.type){const t=(performance.now()-e.time).toFixed(2);document.title=`⚡ PING! (${t}ms)`;const o=document.body.style.backgroundColor;document.body.style.backgroundColor="rgba(255, 0, 0, 0.5)",setTimeout((()=>{document.body.style.backgroundColor=o}),100);let n=document.getElementById("ping-feedback");n||(n=document.createElement("div"),n.id="ping-feedback",n.style.cssText="position:fixed;top:10px;left:50%;transform:translateX(-50%);background:red;color:white;font-weight:bold;padding:10px;z-index:999999;font-size:20px;pointer-events:none;",document.body.appendChild(n)),n.innerText=`PING RECEIVED! ${t}ms`,n.style.display="block",window.pingTimeout&&clearTimeout(window.pingTimeout),window.pingTimeout=setTimeout((()=>{n.style.display="none"}),1e3)}})(e.data)},console.log("⚡ [FastComm] Initialized as "+e.toUpperCase()),c&&setInterval(t,1e3)}catch(e){console.error("⚡ [FastComm] Failed to create BroadcastChannel:",e)}}function t(){a&&c&&(a.postMessage({type:"PING",timestamp:Date.now()}),console.log("⚡ [Master] PING Sent >"))}function o(e){a&&c&&a.postMessage({type:"INPUT",data:{moveUp:e.moveUp,moveDown:e.moveDown,moveLeft:e.moveLeft,moveRight:e.moveRight,inputs:e.inputs}})}const n="survevhack_comms";let a=null,c=!1;export{n as CHANNEL_NAME,e as initCommunication,o as sendInput,t as sendPing};
